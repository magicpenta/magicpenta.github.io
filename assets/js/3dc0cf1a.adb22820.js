"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9286],{3905:(e,a,t)=>{t.d(a,{Zo:()=>s,kt:()=>c});var r=t(7294);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function p(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function k(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var o=r.createContext({}),i=function(e){var a=r.useContext(o),t=a;return e&&(t="function"==typeof e?e(a):p(p({},a),e)),t},s=function(e){var a=i(e.components);return r.createElement(o.Provider,{value:a},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},m=r.forwardRef((function(e,a){var t=e.components,n=e.mdxType,l=e.originalType,o=e.parentName,s=k(e,["components","mdxType","originalType","parentName"]),u=i(t),m=n,c=u["".concat(o,".").concat(m)]||u[m]||d[m]||l;return t?r.createElement(c,p(p({ref:a},s),{},{components:t})):r.createElement(c,p({ref:a},s))}));function c(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var l=t.length,p=new Array(l);p[0]=m;var k={};for(var o in a)hasOwnProperty.call(a,o)&&(k[o]=a[o]);k.originalType=e,k[u]="string"==typeof e?e:n,p[1]=k;for(var i=2;i<l;i++)p[i]=t[i];return r.createElement.apply(null,p)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6751:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>o,contentTitle:()=>p,default:()=>u,frontMatter:()=>l,metadata:()=>k,toc:()=>i});var r=t(7462),n=(t(7294),t(3905));const l={sidebar_position:1},p="Spark \u5feb\u901f\u5165\u95e8",k={unversionedId:"spark/Spark \u5feb\u901f\u5165\u95e8",id:"spark/Spark \u5feb\u901f\u5165\u95e8",title:"Spark \u5feb\u901f\u5165\u95e8",description:"Spark \u7b80\u4ecb",source:"@site/docs/spark/Spark \u5feb\u901f\u5165\u95e8.md",sourceDirName:"spark",slug:"/spark/Spark \u5feb\u901f\u5165\u95e8",permalink:"/docs/spark/Spark \u5feb\u901f\u5165\u95e8",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"defaultSidebar",previous:{title:"Spark",permalink:"/docs/"},next:{title:"Spark \u96c6\u7fa4\u90e8\u7f72",permalink:"/docs/spark/Spark \u96c6\u7fa4\u90e8\u7f72"}},o={},i=[{value:"Spark \u7b80\u4ecb",id:"spark-\u7b80\u4ecb",level:2},{value:"Spark \u6838\u5fc3\u6a21\u5757",id:"spark-\u6838\u5fc3\u6a21\u5757",level:2},{value:"Spark \u8fd0\u884c\u67b6\u6784",id:"spark-\u8fd0\u884c\u67b6\u6784",level:2},{value:"Spark \u8fd0\u884c\u8fc7\u7a0b",id:"spark-\u8fd0\u884c\u8fc7\u7a0b",level:3},{value:"Spark \u5e38\u89c1\u672f\u8bed",id:"spark-\u5e38\u89c1\u672f\u8bed",level:3},{value:"Spark \u8fd0\u884c\u6a21\u5f0f",id:"spark-\u8fd0\u884c\u6a21\u5f0f",level:2},{value:"\u672c\u5730\u6a21\u5f0f",id:"\u672c\u5730\u6a21\u5f0f",level:3},{value:"\u72ec\u7acb\u8fd0\u884c\u6a21\u5f0f",id:"\u72ec\u7acb\u8fd0\u884c\u6a21\u5f0f",level:3},{value:"YARN \u6a21\u5f0f",id:"yarn-\u6a21\u5f0f",level:3},{value:"Spark \u521d\u4f53\u9a8c",id:"spark-\u521d\u4f53\u9a8c",level:2},{value:"Spark \u5e94\u7528\u5f00\u53d1",id:"spark-\u5e94\u7528\u5f00\u53d1",level:3},{value:"Spark \u5e94\u7528\u63d0\u4ea4",id:"spark-\u5e94\u7528\u63d0\u4ea4",level:3},{value:"Spark Shell",id:"spark-shell",level:3}],s={toc:i};function u(e){let{components:a,...l}=e;return(0,n.kt)("wrapper",(0,r.Z)({},s,l,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"spark-\u5feb\u901f\u5165\u95e8"},"Spark \u5feb\u901f\u5165\u95e8"),(0,n.kt)("h2",{id:"spark-\u7b80\u4ecb"},"Spark \u7b80\u4ecb"),(0,n.kt)("p",null,"Apache Spark \u662f\u7528\u4e8e\u5927\u89c4\u6a21\u6570\u636e\u5904\u7406\u7684\u7edf\u4e00\u5206\u6790\u5f15\u64ce\uff0c\u4e0e Hadoop \u8ba1\u7b97\u6846\u67b6 MapReduce \u76f8\u6bd4\uff0cSpark \u5177\u5907\u4ee5\u4e0b\u7279\u70b9\uff1a"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u5f39\u6027\u5206\u5e03\u5f0f\u6570\u636e\u96c6\uff08Resilient Distributed Datasets\uff0c\u7b80\u79f0 RDD\uff09\uff0c\u63d0\u4f9b\u4e86\u6bd4 MapReduce \u66f4\u4e3a\u4e30\u5bcc\u7684\u6a21\u578b"),(0,n.kt)("li",{parentName:"ul"},"\u57fa\u4e8e\u5185\u5b58\u8ba1\u7b97\uff0c\u8ba1\u7b97\u6027\u80fd\u9ad8\u4e8e MapReduce"),(0,n.kt)("li",{parentName:"ul"},"\u6613\u7528\u6027\u597d\uff0c\u63d0\u4f9b\u4e86 Java\u3001Scala\u3001Python \u7b49\u8bed\u8a00\u7684 API\uff0c\u8fd8\u652f\u6301\u7528\u4e8e\u529f\u80fd\u9a8c\u8bc1\u548c\u6d4b\u8bd5\u7684\u4ea4\u4e92\u5f0f Shell"),(0,n.kt)("li",{parentName:"ul"},"\u8d85\u5f3a\u7684\u901a\u7528\u6027\uff0c\u96c6\u79bb\u7ebf\u8ba1\u7b97\u3001\u5b9e\u65f6\u8ba1\u7b97\u3001\u4ea4\u4e92\u5f0f\u67e5\u8be2\u3001\u673a\u5668\u5b66\u4e60\u548c\u56fe\u8ba1\u7b97\u4e8e\u4e00\u4f53")),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"\u5728\u57fa\u4e8e\u5185\u5b58\u8ba1\u7b97\u8fd9\u65b9\u9762\uff0cSpark \u786e\u5b9e\u6bd4 MR \u4f18\u79c0\uff0c\u5b83\u51cf\u5c11\u4e86\u90e8\u5206\u4e2d\u95f4\u7ed3\u679c\u7684\u78c1\u76d8\u8f93\u51fa\u3002\u4f46\u76ee\u524d\u56fd\u5185\u5f88\u591a\u6559\u7a0b\u5bf9\u8fd9\u5757\u7684\u89e3\u8bfb\u662f\u4e0d\u4e25\u8c28\u7684\uff0c\u751a\u81f3\u6709\u77e5\u540d\u8001\u5e08\u8bf4\u51fa\u8fd9\u6837\u5bb9\u6613\u8ba9\u4eba\u8bef\u89e3\u7684\u8a00\u8bba\uff1a",(0,n.kt)("strong",{parentName:"p"},"\u5185\u5b58\u8ba1\u7b97\u7684\u4f18\u52bf\u4e3b\u8981\u4f53\u73b0\u5728 Shuffle \u4e0a\uff0cShuffle \u4f18\u5148\u57fa\u4e8e\u5185\u5b58\u5b9e\u73b0\uff0c\u53ef\u4e0d\u5199\u78c1\u76d8\u3002")," \u5173\u4e8e Spark \u5185\u5b58\u8ba1\u7b97\u7684\u771f\u76f8\uff0c\u53ef\u4ee5\u67e5\u9605\u8fd9\u7bc7\u6587\u7ae0\uff1a",(0,n.kt)("a",{parentName:"p",href:"https://0x0fff.com/spark-misconceptions/"},"https://0x0fff.com/spark-misconceptions\u3002"))),(0,n.kt)("h2",{id:"spark-\u6838\u5fc3\u6a21\u5757"},"Spark \u6838\u5fc3\u6a21\u5757"),(0,n.kt)("p",null,"Spark \u5305\u542b Spark Core\u3001Spark SQL\u3001Spark Streaming\u3001MLlib\u3001GraphX \u7b49\u6a21\u5757\uff0c\u5404\u6a21\u5757\u529f\u80fd\u53ef\u89c1\u4e0b\u8868\uff1a"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"\u6a21\u5757\u540d\u79f0")),(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"\u6a21\u5757\u529f\u80fd")))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Spark Core"),(0,n.kt)("td",{parentName:"tr",align:null},"\u63d0\u4f9b Spark \u6700\u6838\u5fc3\u7684\u529f\u80fd\uff0c\u662f Spark SQL\u3001Spark Streaming \u7b49\u5176\u4ed6\u6a21\u5757\u5b9e\u73b0\u7684\u57fa\u7840")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Spark SQL"),(0,n.kt)("td",{parentName:"tr",align:null},"\u63d0\u4f9b\u57fa\u4e8e SQL \u6216 HQL\uff08Apache Hive \u63d0\u4f9b\u7684 SQL \u65b9\u8a00\uff09\u8fdb\u884c\u6570\u636e\u67e5\u8be2\u7684\u7ec4\u4ef6")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Spark Streaming"),(0,n.kt)("td",{parentName:"tr",align:null},"Spark \u5e73\u53f0\u4e0a\u9488\u5bf9\u5b9e\u65f6\u6570\u636e\u8fdb\u884c\u6d41\u5f0f\u8ba1\u7b97\u7684\u7ec4\u4ef6")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"MLlib"),(0,n.kt)("td",{parentName:"tr",align:null},"Spark \u5e73\u53f0\u7684\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u5e93")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"GraphX"),(0,n.kt)("td",{parentName:"tr",align:null},"Spark \u9762\u5411\u56fe\u8ba1\u7b97\u7684\u7ec4\u4ef6\u4e0e\u7b97\u6cd5\u5e93")))),(0,n.kt)("h2",{id:"spark-\u8fd0\u884c\u67b6\u6784"},"Spark \u8fd0\u884c\u67b6\u6784"),(0,n.kt)("p",null,"Spark \u7684\u8fd0\u884c\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,n.kt)("p",null,(0,n.kt)("img",{src:t(2592).Z,width:"596",height:"286"})),(0,n.kt)("h3",{id:"spark-\u8fd0\u884c\u8fc7\u7a0b"},"Spark \u8fd0\u884c\u8fc7\u7a0b"),(0,n.kt)("p",null,"\u6839\u636e\u8fd0\u884c\u67b6\u6784\u56fe\uff0c\u6211\u4eec\u6765\u7b80\u8ff0\u4e00\u4e0b Spark \u5e94\u7528\u7684\u8fd0\u884c\u8fc7\u7a0b\uff1a"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Driver \u6267\u884c\u7528\u6237\u7a0b\u5e8f\uff08Application\uff09\u7684 ",(0,n.kt)("inlineCode",{parentName:"li"},"main()")," \u65b9\u6cd5\u5e76\u521b\u5efa SparkContext\uff0c\u4e0e Cluster Manager \u5efa\u7acb\u901a\u4fe1"),(0,n.kt)("li",{parentName:"ol"},"Cluster Manager \u4e3a\u7528\u6237\u7a0b\u5e8f\u5206\u914d\u8ba1\u7b97\u8d44\u6e90\uff0c\u8fd4\u56de\u53ef\u4f9b\u4f7f\u7528\u7684 Executor \u5217\u8868"),(0,n.kt)("li",{parentName:"ol"},"\u83b7\u53d6 Executor \u8d44\u6e90\u540e\uff0cSpark \u4f1a\u5c06\u7528\u6237\u7a0b\u5e8f\u4ee3\u7801\u53ca\u4f9d\u8d56\u5305\uff08Application jar\uff09\u4f20\u9012\u7ed9 Executor\uff08\u5373\u79fb\u52a8\u8ba1\u7b97\uff09"),(0,n.kt)("li",{parentName:"ol"},"\u6700\u540e\uff0cSparkContext \u53d1\u9001 tasks\uff08\u7ecf\u62c6\u89e3\u540e\u7684\u4efb\u52a1\u5e8f\u5217\uff09\u5230 Executor\uff0c\u7531\u5176\u6267\u884c\u8ba1\u7b97\u4efb\u52a1\u5e76\u8f93\u51fa\u7ed3\u679c")),(0,n.kt)("h3",{id:"spark-\u5e38\u89c1\u672f\u8bed"},"Spark \u5e38\u89c1\u672f\u8bed"),(0,n.kt)("p",null,"\u5728 Spark \u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u5b58\u5728\u4e00\u4e9b\u672f\u8bed\u3002\u4e3a\u65b9\u4fbf\u7406\u89e3\uff0c\u6211\u4eec\u5c06\u8fd9\u4e9b\u672f\u8bed\u53ca\u5176\u542b\u4e49\u6574\u7406\u5982\u4e0b\uff1a"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"\u672f\u8bed")),(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"\u542b\u4e49")))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Application"),(0,n.kt)("td",{parentName:"tr",align:null},"\u57fa\u4e8e Spark \u6784\u5efa\u7684\u7528\u6237\u7a0b\u5e8f")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Application jar"),(0,n.kt)("td",{parentName:"tr",align:null},"\u5305\u542b\u7528\u6237 Spark \u5e94\u7528\u7a0b\u5e8f\u7684 jar \u5305\uff08\u4e0d\u5305\u542b Hadoop \u548c Spark \u4f9d\u8d56\u5305\uff0c\u8fd0\u884c\u65f6\u7531\u96c6\u7fa4\u5bfc\u5165\uff09")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Driver Program"),(0,n.kt)("td",{parentName:"tr",align:null},"\u8fd0\u884c\u7528\u6237\u7a0b\u5e8f ",(0,n.kt)("inlineCode",{parentName:"td"},"main()")," \u51fd\u6570\u5e76\u521b\u5efa SparkContext \u7684\u8fdb\u7a0b")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"SparkContext"),(0,n.kt)("td",{parentName:"tr",align:null},"\u7528\u6237\u7a0b\u5e8f\u4e0e Spark \u96c6\u7fa4\u4ea4\u4e92\u7684\u4e3b\u8981\u5165\u53e3\uff0c\u7528\u4e8e\u521b\u5efa RDD\u3001\u7d2f\u52a0\u5668\u548c\u5e7f\u64ad\u53d8\u91cf\u7b49")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Cluster Manager"),(0,n.kt)("td",{parentName:"tr",align:null},"\u96c6\u7fa4\u8d44\u6e90\u7ba1\u7406\u5668\uff0c\u5176\u5b9e\u73b0\u53ef\u4ee5\u662f Standalone\u3001Mesos\u3001YARN \u6216 Kubernetes")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Master Node"),(0,n.kt)("td",{parentName:"tr",align:null},"\u72ec\u7acb\u90e8\u7f72\u96c6\u7fa4\u4e2d\u7684\u4e3b\u8282\u70b9\uff0c\u8d1f\u8d23\u8d44\u6e90\u8c03\u5ea6\uff0c\u7c7b\u6bd4 Yarn \u4e2d\u7684 ResourceManager")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Worker Node"),(0,n.kt)("td",{parentName:"tr",align:null},"\u72ec\u7acb\u90e8\u7f72\u96c6\u7fa4\u4e2d\u7684\u4ece\u8282\u70b9\uff0c\u8d1f\u8d23\u6267\u884c\u8ba1\u7b97\u4efb\u52a1\uff0c\u7c7b\u6bd4 Yarn \u4e2d\u7684 NodeManager")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Executor"),(0,n.kt)("td",{parentName:"tr",align:null},"Worker \u8282\u70b9\u4e0a\u8d1f\u8d23\u6267\u884c\u5b9e\u9645\u8ba1\u7b97\u4efb\u52a1\u7684\u7ec4\u4ef6")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Task"),(0,n.kt)("td",{parentName:"tr",align:null},"\u5206\u533a\u7ea7\u522b\u7684\u8ba1\u7b97\u4efb\u52a1\uff0c\u662f Spark \u4e2d\u6700\u57fa\u672c\u7684\u4efb\u52a1\u6267\u884c\u5355\u5143")))),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"\u6b64\u5904\u7684 Task \u4e0e\u7528\u6237\u63d0\u4ea4\u7684\u8ba1\u7b97\u5e94\u7528\u4e0d\u662f\u540c\u4e00\u4e2a\u6982\u5ff5\u3002\u7528\u6237\u63d0\u4ea4\u7684\u8ba1\u7b97\u5e94\u7528\u5bf9\u5e94\u4e8e\u4e00\u4e2a\u6216\u591a\u4e2a Job\uff0c\u6bcf\u4e2a Job \u53ef\u62c6\u5206\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a Stage\uff0c\u6bcf\u4e2a Stage \u53c8\u7531\u4e00\u4e2a\u6216\u591a\u4e2a Task \u7ec4\u6210\uff0c\u7b80\u800c\u8a00\u4e4b\uff0c\u5373 ",(0,n.kt)("strong",{parentName:"p"},"Job > Stage > Task"),"\u3002\u5173\u4e8e Job\u3001Stage\u3001Task \u4e09\u8005\u95f4\u7684\u5177\u4f53\u5173\u7cfb\uff0c\u5c06\u5728\u540e\u7eed\u7bc7\u7ae0\u8fdb\u884c\u8ba8\u8bba\u3002")),(0,n.kt)("h2",{id:"spark-\u8fd0\u884c\u6a21\u5f0f"},"Spark \u8fd0\u884c\u6a21\u5f0f"),(0,n.kt)("p",null,"Spark \u7684\u8fd0\u884c\u6a21\u5f0f\u5305\u542b\u672c\u5730\u6a21\u5f0f\u3001\u72ec\u7acb\u8fd0\u884c\u6a21\u5f0f\u3001Mesos\u3001YARN\u3001Kubernetes \u7b49\u3002\u7528\u6237\u53ef\u4ee5\u5728\u63d0\u4ea4 Spark \u5e94\u7528\u65f6\u901a\u8fc7\u53c2\u6570 ",(0,n.kt)("inlineCode",{parentName:"p"},"--master")," \u6307\u5b9a Spark \u7684\u8fd0\u884c\u6a21\u5f0f\u3002"),(0,n.kt)("p",null,"\u672c\u8282\u7b80\u8981\u4ecb\u7ecd\u51e0\u79cd\u5728\u56fd\u5185\u6bd4\u8f83\u5e38\u89c1\u7684\u8fd0\u884c\u6a21\u5f0f\u3002"),(0,n.kt)("h3",{id:"\u672c\u5730\u6a21\u5f0f"},"\u672c\u5730\u6a21\u5f0f"),(0,n.kt)("p",null,"\u672c\u5730\u6a21\u5f0f\uff08Local\uff09\u7531\u5355\u673a\u7684\u591a\u4e2a\u7ebf\u7a0b\u6a21\u62df Spark \u5206\u5e03\u5f0f\u8ba1\u7b97\uff0c\u76f4\u63a5\u8fd0\u884c\u5728\u672c\u5730\uff0c\u5e38\u7528\u4e8e\u5f00\u53d1\u8c03\u8bd5\u3002"),(0,n.kt)("p",null,"\u4f7f\u7528\u672c\u5730\u6a21\u5f0f\u65f6\uff0c",(0,n.kt)("inlineCode",{parentName:"p"},"--master")," \u53ef\u4ee5\u6709\u4ee5\u4e0b\u51e0\u79cd\u53d6\u503c\uff1a"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"local\uff1a\u53ea\u542f\u52a8\u4e00\u4e2a Executor"),(0,n.kt)("li",{parentName:"ul"},"local","[N]","\uff1a\u542f\u52a8 N \u4e2a Executor"),(0,n.kt)("li",{parentName:"ul"},"local","[*]","\uff1a\u542f\u52a8\u4e0e CPU \u6838\u6570\u76f8\u540c\u7684 Executor")),(0,n.kt)("h3",{id:"\u72ec\u7acb\u8fd0\u884c\u6a21\u5f0f"},"\u72ec\u7acb\u8fd0\u884c\u6a21\u5f0f"),(0,n.kt)("p",null,"\u72ec\u7acb\u8fd0\u884c\u6a21\u5f0f\uff08Standalone\uff09\u4ee5\u7ecf\u5178\u7684 Master-Slave \u6a21\u5f0f\u90e8\u7f72 Spark \u96c6\u7fa4\uff0c\u7531 Spark \u72ec\u7acb\u63d0\u4f9b\u8ba1\u7b97\u8d44\u6e90\u3002"),(0,n.kt)("p",null,"\u4f7f\u7528\u72ec\u7acb\u8fd0\u884c\u6a21\u5f0f\u65f6\uff0c",(0,n.kt)("inlineCode",{parentName:"p"},"--master")," \u7684\u53d6\u503c\u4e3a Master \u8282\u70b9\u7684\u5730\u5740\uff0c\u4f8b\u5982\uff1a",(0,n.kt)("inlineCode",{parentName:"p"},"spark://master:7077"),"\u3002"),(0,n.kt)("h3",{id:"yarn-\u6a21\u5f0f"},"YARN \u6a21\u5f0f"),(0,n.kt)("p",null,"YARN \u6a21\u5f0f\u7531 YARN \u5b8c\u6210\u96c6\u7fa4\u8ba1\u7b97\u8d44\u6e90\u7684\u8c03\u5ea6\uff0c\u65e0\u9700\u90e8\u7f72\u548c\u542f\u52a8 Spark \u96c6\u7fa4\u3002"),(0,n.kt)("p",null,"\u4f7f\u7528 YARN \u6a21\u5f0f\u65f6\uff0c\u53ea\u9700\u6307\u5b9a ",(0,n.kt)("inlineCode",{parentName:"p"},"--master")," \u4e3a ",(0,n.kt)("inlineCode",{parentName:"p"},"yarn")," \u5373\u53ef\u3002"),(0,n.kt)("h2",{id:"spark-\u521d\u4f53\u9a8c"},"Spark \u521d\u4f53\u9a8c"),(0,n.kt)("p",null,"\u672c\u8282\u5c06\u5c55\u793a\u4e00\u4e2a Spark \u5e94\u7528\u7a0b\u5e8f\u4ece\u4ee3\u7801\u7f16\u5199\u5230\u63d0\u4ea4\u6267\u884c\u7684\u8fc7\u7a0b\uff0c\u4ee5\u52a0\u6df1\u6211\u4eec\u5bf9\u4e0a\u8ff0\u77e5\u8bc6\u7684\u7406\u89e3\u3002"),(0,n.kt)("h3",{id:"spark-\u5e94\u7528\u5f00\u53d1"},"Spark \u5e94\u7528\u5f00\u53d1"),(0,n.kt)("p",null,"Spark \u63d0\u4f9b\u4e86 Java\u3001Scala\u3001Python \u7b49\u8bed\u8a00\u7684 API\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 Scala \u8fdb\u884c Spark \u5e94\u7528\u7684\u5f00\u53d1\u3002"),(0,n.kt)("p",null,"\u9996\u5148\uff0c\u4f7f\u7528 Maven \u521b\u5efa Scala \u9879\u76ee\uff0c\u5e76\u6dfb\u52a0 Spark \u7684\u4f9d\u8d56\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.apache.spark</groupId>\n    <artifactId>spark-core_2.12</artifactId>\n    <version>3.1.2</version>\n    <scope>provided</scope>\n</dependency>\n")),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"Scala \u7684\u7248\u672c\u4e0e Spark \u8981\u4fdd\u6301\u4e00\u81f4\uff0c\u907f\u514d\u51fa\u73b0\u517c\u5bb9\u6027\u95ee\u9898\u3002\u5177\u4f53\u7248\u53f7\u5bf9\u7167\uff0c\u53ef\u53c2\u8003 Spark \u5b98\u7f51\u3002")),(0,n.kt)("p",null,"\u7136\u540e\uff0c\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u8bcd\u9891\u7edf\u8ba1\u7684\u8ba1\u7b97\u7a0b\u5e8f\uff0c\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-scala"},'import org.apache.spark.rdd.RDD\nimport org.apache.spark.{SparkConf, SparkContext}\n\nobject WordCount {\n\n  def main(args: Array[String]): Unit = {\n    val conf: SparkConf = new SparkConf().setMaster("local").setAppName("WordCount App")\n    val sc: SparkContext = new SparkContext(conf)\n\n    // \u8bfb\u53d6\u6bcf\u884c\u6570\u636e\n    val lines: RDD[String] = sc.textFile("data/wc.txt")\n    // \u83b7\u53d6\u6240\u6709\u5355\u8bcd\n    val words: RDD[String] = lines.flatMap(_.split(" "))\n    // \u5c06\u5355\u8bcd\u8f6c\u4e3a map\uff0c\u4f8b\u5982\uff1a(spark, 1)\n    val wordMap: RDD[(String, Int)] = words.map((_, 1))\n    // \u6839\u636e key \u8fdb\u884c\u805a\u5408\uff0c\u5f97\u51fa\u8bcd\u9891\u96c6\u5408\n    val results: RDD[(String, Int)] = wordMap.reduceByKey(_ + _)\n\n    results.collect().foreach(result => println(result))\n  }\n}\n')),(0,n.kt)("p",null,"\u5b8c\u6210\u4ee3\u7801\u5f00\u53d1\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,n.kt)("inlineCode",{parentName:"p"},"mvn clean package")," \u547d\u4ee4\u8fdb\u884c\u6253\u5305\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6253\u5305\u540e\u7684 jar \u5305\u540d\u4e3a ",(0,n.kt)("inlineCode",{parentName:"p"},"spark-demo-1.0.0.jar"),"\u3002"),(0,n.kt)("h3",{id:"spark-\u5e94\u7528\u63d0\u4ea4"},"Spark \u5e94\u7528\u63d0\u4ea4"),(0,n.kt)("p",null,"\u5c06\u4e0a\u8ff0 jar \u5305\u4e0a\u4f20\u81f3 Spark \u5b89\u88c5\u76ee\u5f55\u4e0b\uff0c\u4f7f\u7528 ",(0,n.kt)("inlineCode",{parentName:"p"},"spark-submit")," \u4ee5\u672c\u5730\u6a21\u5f0f\u63d0\u4ea4\u5e94\u7528\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"bin/spark-submit \\\n--class com.panda.WordCount \\\n--master local \\\nspark-demo-1.0.0.jar\n")),(0,n.kt)("p",null,"\u5176\u4e2d\uff0c",(0,n.kt)("inlineCode",{parentName:"p"},"--class")," \u7528\u4e8e\u6307\u5b9a\u7528\u6237\u7a0b\u5e8f\u7684\u4e3b\u7c7b\uff0c",(0,n.kt)("inlineCode",{parentName:"p"},"--master")," \u7528\u4e8e\u6307\u5b9a\u8fd0\u884c\u6a21\u5f0f\u3002"),(0,n.kt)("p",null,"\u63d0\u4ea4\u540e\uff0c\u5373\u53ef\u5728\u63a7\u5236\u53f0\u770b\u5230\u8bcd\u9891\u7edf\u8ba1\u7ed3\u679c\u3002"),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"\u4f7f\u7528\u672c\u5730\u6a21\u5f0f\u63d0\u4ea4\u4f5c\u4e1a\u65f6\uff0c\u65e0\u9700\u542f\u52a8 Driver \u548c Executor\u3002\u5b83\u4f1a\u542f\u52a8 SparkSubmit \u8fdb\u7a0b\uff0c\u7531\u8be5\u8fdb\u7a0b\u5145\u5f53 Driver \u548c Executor \u7684\u89d2\u8272\uff0c\u5e76\u4e14\u5728\u7528\u6237\u7a0b\u5e8f\u6267\u884c\u5b8c\u6bd5\u540e\u7ec8\u6b62\u3002")),(0,n.kt)("h3",{id:"spark-shell"},"Spark Shell"),(0,n.kt)("p",null,"\u9664\u4e86 ",(0,n.kt)("inlineCode",{parentName:"p"},"spark-submit")," \u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528 ",(0,n.kt)("inlineCode",{parentName:"p"},"spark-shell")," \u63d0\u4ea4\u8ba1\u7b97\u5e94\u7528\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-\u7eaf\u6587\u672c"},"[root@master bin]# ./spark-shell \n21/10/08 15:27:21 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nUsing Spark's default log4j profile: org/apache/spark/log4j-defaults.properties\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\nSpark context Web UI available at http://master:4040\nSpark context available as 'sc' (master = local[*], app id = local-1633678049624).\nSpark session available as 'spark'.\nWelcome to\n      ____              __\n     / __/__  ___ _____/ /__\n    _\\ \\/ _ \\/ _ `/ __/  '_/\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 3.1.2\n      /_/\n         \nUsing Scala version 2.12.10 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_251)\nType in expressions to have them evaluated.\nType :help for more information.\n\nscala>\n")),(0,n.kt)("p",null,"\u6b63\u5982\u65e5\u5fd7\u4e2d\u663e\u793a\u7684\uff0c\u5728\u4ea4\u4e92\u754c\u9762\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 ",(0,n.kt)("inlineCode",{parentName:"p"},"sc")," \u83b7\u5f97 SparkContext \u5bf9\u8c61\uff0c\u901a\u8fc7 ",(0,n.kt)("inlineCode",{parentName:"p"},"spark")," \u83b7\u5f97 SparkSession \u5bf9\u8c61\uff0c\u65e0\u9700\u518d\u5bf9\u5176\u8fdb\u884c\u521d\u59cb\u5316\u64cd\u4f5c\u3002"),(0,n.kt)("p",null,"\u5728\u4ea4\u4e92\u754c\u9762\u4e2d\uff0c\u8bcd\u9891\u7edf\u8ba1\u7684\u5b9e\u73b0\u663e\u5f97\u66f4\u4e3a\u7b80\u5355\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-scala"},'scala> sc.textFile("data/wc.txt").flatMap(_.split(" ")).map((_, 1)).reduceByKey(_ + _).collect()\n\n')),(0,n.kt)("p",null,"\u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\u540e\uff0c\u63a7\u5236\u53f0\u4fbf\u53ef\u4ee5\u8f93\u51fa\u7edf\u8ba1\u7ed3\u679c\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-\u7eaf\u6587\u672c"},"res5: Array[(String, Int)] = Array((word,1), (hello,2), (spark,1))\n")),(0,n.kt)("p",null,"\u4e0e\u6b64\u540c\u65f6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7 Web UI \u6765\u67e5\u770b\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u7ec6\u8282\uff0c\u5982\u56fe\u6240\u793a\uff1a"),(0,n.kt)("p",null,(0,n.kt)("img",{src:t(4096).Z,width:"2558",height:"1336"})),(0,n.kt)("p",null,"\u663e\u7136\uff0c\u4e0e ",(0,n.kt)("inlineCode",{parentName:"p"},"spark-submit")," \u76f8\u6bd4\uff0c",(0,n.kt)("inlineCode",{parentName:"p"},"spark-shell")," \u65e0\u9700\u4e0a\u4f20 jar \u5305\uff0c\u66f4\u6613\u4e8e\u529f\u80fd\u7684\u5f00\u53d1\u4e0e\u8c03\u8bd5\u3002"))}u.isMDXComponent=!0},2592:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/framework-56104e472f74a6c1246ef03d93a7cd4e.png"},4096:(e,a,t)=>{t.d(a,{Z:()=>r});const r=t.p+"assets/images/spark_web_ui-8469b0b353ba497e025f5a2cebda74f7.png"}}]);